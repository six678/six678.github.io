<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>é€‰å·å·¥å…· - 158930.COM</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #3498db;
            --red: #e74c3c;
            --green: #2ecc71;
            --bg: #f4f7f6;
            --white: #ffffff;
            --header-bg: #2c3e50;
        }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", Roboto, Helvetica, Arial, sans-serif; 
            background: var(--bg); 
            color: #333; 
            margin: 0; 
            padding: 0;
            touch-action: manipulation; 
            padding-bottom: 40px;
        }

        /* === ä¿®å¤é‡ç‚¹ï¼šå¤´éƒ¨å±‚çº§æå‡åˆ° 1001 === */
        .app-header {
            background: var(--header-bg);
            color: white;
            padding: 0 15px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1001; /* å…³é”®ä¿®æ”¹ï¼šæ¯”é®ç½©å±‚é«˜ */
        }

        .header-left, .header-right {
            display: flex;
            align-items: center;
            width: 60px;
        }
        .header-right { justify-content: flex-end; position: relative; }

        .header-title {
            font-size: 16px;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .btn-icon-header {
            width: 36px; height: 36px;
            display: flex; align-items: center; justify-content: center;
            border-radius: 50%;
            text-decoration: none;
            color: white;
            font-size: 20px;
            transition: background 0.2s;
            cursor: pointer;
        }
        .btn-icon-header:active { background: rgba(255,255,255,0.2); }

        /* === ä¿®å¤é‡ç‚¹ï¼šé®ç½©å±‚å±‚çº§è®¾ä¸º 1000 === */
        .menu-overlay {
            position: fixed; inset: 0; 
            z-index: 1000; /* å…³é”®ä¿®æ”¹ï¼šæ¯”å¤´éƒ¨ä½ */
            display: none;
            /* background: rgba(0,0,0,0.1); å¯é€‰ï¼šåŠ ä¸€ç‚¹åº•è‰²æ–¹ä¾¿è°ƒè¯• */
        }

        .pop-menu {
            position: absolute;
            top: 45px;
            right: 0;
            width: 160px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            padding: 8px;
            display: none;
            flex-direction: column;
            transform-origin: top right;
            animation: scaleIn 0.2s ease forwards;
            border: 1px solid rgba(0,0,0,0.05);
            /* æ³¨æ„ï¼šèœå•æ˜¯ header çš„å­å…ƒç´ ï¼Œè‡ªç„¶è·Ÿéš header çš„ z-index 1001 */
        }
        @keyframes scaleIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
        
        .menu-item {
            display: flex; align-items: center; gap: 12px;
            padding: 12px 15px;
            color: #333;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            border-radius: 8px;
            transition: background 0.1s;
        }
        .menu-item:active { background: #f5f7fa; }
        .menu-item.active { color: var(--accent); background: #f0f9ff; }
        .menu-icon { width: 20px; text-align: center; font-size: 16px; }

        /* Sticky Tab */
        .sticky-tab-bar {
            position: sticky;
            top: 50px;
            z-index: 100;
            background: var(--bg);
            padding: 10px 15px;
        }

        .nav-tabs {
            display: flex;
            background: #e0e5e9;
            padding: 4px;
            border-radius: 10px;
        }
        .nav-item {
            flex: 1;
            text-align: center;
            padding: 8px 0;
            font-size: 14px;
            font-weight: 600;
            color: #7f8c8d;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .nav-item.active {
            background: var(--white);
            color: var(--primary);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .tab-content { display: none; padding: 15px; animation: fadeIn 0.2s ease; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* å¡ç‰‡ä¸å¸ƒå±€ */
        .section { background: var(--white); padding: 20px; border-radius: 16px; box-shadow: 0 4px 15px rgba(0,0,0,0.03); margin-bottom: 20px; }
        
        textarea.data-input { 
            width: 100%; height: 140px; padding: 15px; border: 1px solid #e0e0e0; border-radius: 12px; 
            box-sizing: border-box; font-family: 'Monaco', monospace; font-size: 14px; resize: none;
            background: #fafafa; outline: none; transition: border 0.2s;
        }
        textarea.data-input:focus { border-color: var(--accent); background: #fff; }

        .action-bar { display: flex; gap: 10px; margin-top: 15px; }
        .btn-stat { flex: 1; height: 44px; border: none; border-radius: 10px; font-weight: 600; font-size: 15px; color: white; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px; }
        .btn-run { background: var(--green); box-shadow: 0 4px 10px rgba(46, 204, 113, 0.3); }
        .btn-copy { background: var(--accent); box-shadow: 0 4px 10px rgba(52, 152, 219, 0.3); display: none; }
        .btn-clear { background: #95a5a6; flex: 0.4; }

        .stats-container { margin-top: 15px; }
        .stat-group { background: white; margin-bottom: 10px; padding: 12px; border-radius: 12px; box-shadow: 0 2px 5px rgba(0,0,0,0.02); }
        .stat-header { display: flex; justify-content: space-between; font-size: 12px; color: #999; margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.5px; }
        .stat-nums { font-family: 'Monaco', monospace; font-size: 16px; color: #333; line-height: 1.5; word-break: break-all; }
        .hot-num { color: var(--red); font-weight: 800; }

        /* é€‰å·å·¥å…·æ ·å¼ */
        .result-sticky-bar {
            background: var(--white);
            border-radius: 16px;
            padding: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            margin-bottom: 20px;
            border: 1px solid rgba(0,0,0,0.02);
        }

        .result-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .result-title { font-size: 16px; color: var(--primary); font-weight: 700; margin: 0; }
        .count-badge { background: var(--accent); color: white; padding: 2px 8px; border-radius: 12px; font-size: 13px; margin-left: 5px; }
        
        .btn-copy-sm {
            background: #edf2f7; color: var(--primary); border: none; padding: 6px 12px; 
            border-radius: 8px; font-size: 12px; font-weight: 600; cursor: pointer;
        }

        .ball-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 6px; justify-items: center; }
        .ball {
            display: flex; justify-content: center; align-items: center;
            width: 34px; height: 34px; border-radius: 50%;
            font-weight: 700; color: white; font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.15); transition: all 0.25s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .ball.red { background: linear-gradient(135deg, #ff7675, #d63031); }
        .ball.blue { background: linear-gradient(135deg, #74b9ff, #0984e3); }
        .ball.green { background: linear-gradient(135deg, #55efc4, #00b894); }
        .ball.disabled { opacity: 0.2; filter: grayscale(100%); transform: scale(0.6); box-shadow: none; }

        .filter-section-title {
            font-size: 13px; font-weight: 700; color: #95a5a6; margin: 20px 0 10px 0; 
            text-transform: uppercase; letter-spacing: 1px; display: flex; align-items: center;
        }
        .filter-section-title::after { content: ''; flex: 1; height: 1px; background: #eee; margin-left: 10px; }

        .settings-bar { 
            background: #fff8e1; color: #f39c12; padding: 12px; border-radius: 10px; 
            margin-bottom: 15px; font-size: 14px; display: flex; align-items: center; justify-content: space-between;
        }
        select { border: none; background: transparent; font-weight: bold; color: #e67e22; font-size: 15px; outline: none; }

        .custom-textarea {
            width: 100%; height: 80px; padding: 12px; border: 1px solid #eee; border-radius: 10px;
            background: #fafafa; margin-bottom: 10px; font-size: 14px; resize: none;
        }
        .custom-action-bar { display: flex; gap: 10px; }
        .btn-apply { flex: 2; background: var(--primary); color: white; border: none; padding: 10px; border-radius: 8px; font-weight: 600; }
        .btn-reset { flex: 1; background: #fff0f0; color: var(--red); border: 1px solid #ffcdd2; padding: 10px; border-radius: 8px; font-weight: 600; }

        .btn-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(60px, 1fr)); gap: 8px; }
        .filter-btn {
            border: 1px solid #f0f0f0; background: white; padding: 12px 0; border-radius: 10px; 
            font-size: 13px; color: #555; transition: all 0.2s; font-weight: 500;
        }
        .filter-btn.active { 
            background: var(--primary); color: white; border-color: var(--primary); 
            box-shadow: 0 4px 10px rgba(44, 62, 80, 0.2); transform: translateY(-1px);
        }
    </style>
</head>
<body>

    <header class="app-header">
        <div class="header-left">
            <a href="index.html" class="btn-icon-header">ğŸ </a>
        </div>
        <div class="header-title">é€‰å·å·¥å…·</div>
        <div class="header-right">
            <div class="btn-icon-header" onclick="toggleMenu()">â¸¬</div>
            <div class="pop-menu" id="navMenu">
                <a href="index.html" class="menu-item">
                    <span class="menu-icon">ğŸ </span> é¦–é¡µé—¨æˆ·
                </a>
                <a href="tool_filter.html" class="menu-item active">
                    <span class="menu-icon">ğŸ“Š</span> é€‰å·å·¥å…·
                </a>
                <a href="tool_analysis.html" class="menu-item">
                    <span class="menu-icon">ğŸ›¡ï¸</span> å†å²åˆ†æ
                </a>
            </div>
        </div>
    </header>
    
    <div class="menu-overlay" id="menuOverlay" onclick="toggleMenu()"></div>

    <div class="sticky-tab-bar">
        <nav class="nav-tabs">
            <div class="nav-item active" onclick="switchTab('stats')">ğŸ“Š å·ç ç»Ÿè®¡</div>
            <div class="nav-item" onclick="switchTab('filter')">ğŸ›¡ï¸ é€‰å·è¿‡æ»¤</div>
        </nav>
    </div>

    <div id="tab-stats" class="tab-content active">
        <div class="section">
            <textarea id="historyInput" class="data-input" placeholder="åœ¨æ­¤ç²˜è´´å†å²å¼€å¥–è®°å½•...&#10;æ”¯æŒæ ¼å¼ï¼š&#10;001æœŸ 01 05 12...&#10;002æœŸ 18 20 33..."></textarea>
            
            <div class="action-bar">
                <button class="btn-stat btn-run" onclick="analyzeHistory()">â–¶ å¼€å§‹ç»Ÿè®¡</button>
                <button id="btnCopy" class="btn-stat btn-copy" onclick="copyStats()">ğŸ“‹ å¤åˆ¶ç»“æœ</button>
                <button class="btn-stat btn-clear" onclick="clearStats()">æ¸…ç©º</button>
            </div>
        </div>
        <div id="statsOutput" class="stats-container"></div>
    </div>

    <div id="tab-filter" class="tab-content">
        <div class="settings-bar">
            <span>âš™ï¸ å½“å‰å¹´ä»½è®¾ç½®</span>
            <select id="yearZodiac" onchange="initApp()"></select>
        </div>

        <div class="result-sticky-bar">
            <div class="result-header">
                <h2 class="result-title">å‰©ä½™ç»“æœ <span class="count-badge" id="result-count">49</span></h2>
                <button class="btn-copy-sm" id="btnCopyResult" onclick="copyFilterResults()">å¤åˆ¶å·ç </button>
            </div>
            <div id="numbersGrid" class="ball-grid"></div>
        </div>

        <div class="section">
            <div class="filter-group">
                <div class="filter-section-title">è‡ªå®šä¹‰æ’é™¤</div>
                <textarea id="customFilterInput" class="custom-textarea" placeholder="è¾“å…¥å·ç æˆ–ç”Ÿè‚–ï¼Œç©ºæ ¼éš”å¼€ (ä¾‹: 01 é¼  49)"></textarea>
                <div class="custom-action-bar">
                    <button class="btn-apply" onclick="applyCustomFilter()">ğŸš« æ‰§è¡Œæ’é™¤</button>
                    <button class="btn-reset" onclick="resetFilters()">ğŸ”„ é‡ç½®</button>
                </div>
            </div>

            <div class="filter-group">
                <div class="filter-section-title">æŒ‰å¤´æ•°æ’é™¤</div>
                <div class="btn-grid" style="grid-template-columns: repeat(5, 1fr);">
                    <button class="filter-btn" onclick="toggleFilter('head', 0, this)">0å¤´</button>
                    <button class="filter-btn" onclick="toggleFilter('head', 1, this)">1å¤´</button>
                    <button class="filter-btn" onclick="toggleFilter('head', 2, this)">2å¤´</button>
                    <button class="filter-btn" onclick="toggleFilter('head', 3, this)">3å¤´</button>
                    <button class="filter-btn" onclick="toggleFilter('head', 4, this)">4å¤´</button>
                </div>
            </div>

            <div class="filter-group">
                <div class="filter-section-title">æŒ‰å°¾æ•°æ’é™¤</div>
                <div class="btn-grid" style="grid-template-columns: repeat(5, 1fr);">
                    <button class="filter-btn" onclick="toggleFilter('tail', 1, this)">1å°¾</button>
                    <button class="filter-btn" onclick="toggleFilter('tail', 2, this)">2å°¾</button>
                    <button class="filter-btn" onclick="toggleFilter('tail', 3, this)">3å°¾</button>
                    <button class="filter-btn" onclick="toggleFilter('tail', 4, this)">4å°¾</button>
                    <button class="filter-btn" onclick="toggleFilter('tail', 5, this)">5å°¾</button>
                    <button class="filter-btn" onclick="toggleFilter('tail', 6, this)">6å°¾</button>
                    <button class="filter-btn" onclick="toggleFilter('tail', 7, this)">7å°¾</button>
                    <button class="filter-btn" onclick="toggleFilter('tail', 8, this)">8å°¾</button>
                    <button class="filter-btn" onclick="toggleFilter('tail', 9, this)">9å°¾</button>
                    <button class="filter-btn" onclick="toggleFilter('tail', 0, this)">0å°¾</button>
                </div>
            </div>

            <div class="filter-group">
                <div class="filter-section-title">æŒ‰æ³¢è‰² / å•åŒ / å¤§å°</div>
                <div class="btn-grid" style="grid-template-columns: repeat(3, 1fr); margin-bottom: 10px;">
                    <button class="filter-btn" onclick="toggleFilter('color', 'red', this)" style="color:var(--red)">æ€çº¢æ³¢</button>
                    <button class="filter-btn" onclick="toggleFilter('color', 'blue', this)" style="color:var(--accent)">æ€è“æ³¢</button>
                    <button class="filter-btn" onclick="toggleFilter('color', 'green', this)" style="color:var(--green)">æ€ç»¿æ³¢</button>
                </div>
                <div class="btn-grid" style="grid-template-columns: repeat(4, 1fr);">
                    <button class="filter-btn" onclick="toggleFilter('parity', 'odd', this)">æ€å•</button>
                    <button class="filter-btn" onclick="toggleFilter('parity', 'even', this)">æ€åŒ</button>
                    <button class="filter-btn" onclick="toggleFilter('size', 'small', this)">æ€å°</button>
                    <button class="filter-btn" onclick="toggleFilter('size', 'big', this)">æ€å¤§</button>
                </div>
            </div>

            <div class="filter-group">
                <div class="filter-section-title">æŒ‰ç”Ÿè‚–æ’é™¤</div>
                <div class="btn-grid" id="zodiacFilters" style="grid-template-columns: repeat(4, 1fr);"></div>
            </div>
        </div>
    </div>

<script>
    function toggleMenu() {
        const menu = document.getElementById('navMenu');
        const overlay = document.getElementById('menuOverlay');
        if (menu.style.display === 'flex') {
            menu.style.display = 'none';
            overlay.style.display = 'none';
        } else {
            menu.style.display = 'flex';
            overlay.style.display = 'block';
        }
    }

    const totalNums = 49;
    const zodiacs = ['é¼ ', 'ç‰›', 'è™', 'å…”', 'é¾™', 'è›‡', 'é©¬', 'ç¾Š', 'çŒ´', 'é¸¡', 'ç‹—', 'çŒª'];
    const waves = {
        red: [1, 2, 7, 8, 12, 13, 18, 19, 23, 24, 29, 30, 34, 35, 40, 45, 46],
        blue: [3, 4, 9, 10, 14, 15, 20, 25, 26, 31, 36, 37, 41, 42, 47, 48],
        green: [5, 6, 11, 16, 17, 21, 22, 27, 28, 32, 33, 38, 39, 43, 44, 49]
    };

    let activeFilters = { color: [], parity: [], size: [], zodiac: [], tail: [], head: [], customNums: [] };
    let currentZodiacIndex = 5; 
    let statsTextForCopy = "";

    window.onload = function() { initYearSelect(); initApp(); };

    window.switchTab = function(tabName) {
        document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
        document.getElementById('tab-' + tabName).classList.add('active');
        const tabs = document.querySelectorAll('.nav-item');
        if(tabName === 'stats') tabs[0].classList.add('active');
        else tabs[1].classList.add('active');
    }

    window.analyzeHistory = function() {
        const input = document.getElementById('historyInput');
        const output = document.getElementById('statsOutput');
        const btnCopy = document.getElementById('btnCopy');
        const regex = /\b(0?[1-9]|[1-4][0-9])\b/g;
        const matches = input.value.match(regex);
        
        output.innerHTML = ''; statsTextForCopy = "";

        if (!matches || matches.length === 0) {
            output.innerHTML = '<div style="text-align:center; padding:30px; color:#999; font-size:13px;">âš ï¸ è¯·å…ˆè¾“å…¥æœ‰æ•ˆæ•°æ®</div>';
            btnCopy.style.display = 'none'; return;
        }

        const counts = {};
        matches.forEach(m => { const num = parseInt(m, 10); if (num >= 1 && num <= 49) counts[num] = (counts[num] || 0) + 1; });
        const groups = {};
        Object.keys(counts).forEach(numKey => {
            const num = parseInt(numKey); const count = counts[numKey];
            if (!groups[count]) groups[count] = []; groups[count].push(num);
        });
        const appeared = Object.keys(counts).map(Number);
        const missing = [];
        for(let i=1; i<=49; i++) if(!appeared.includes(i)) missing.push(i);
        if (missing.length > 0) groups[0] = missing;
        const sortedCounts = Object.keys(groups).map(Number).sort((a, b) => b - a);
        let html = ''; let plainText = 'ã€å·ç ç»Ÿè®¡ç»“æœã€‘\n';

        sortedCounts.forEach(count => {
            const nums = groups[count].sort((a, b) => a - b);
            const fmtNums = nums.map(n => n < 10 ? '0' + n : n);
            const numsStr = fmtNums.join(', '); const isHot = count >= 3;
            html += `<div class="stat-group"><div class="stat-header"><span>å‡ºç° ${count} æ¬¡</span><span>å…± ${nums.length} ç </span></div><div class="stat-nums ${isHot ? 'hot-num' : ''}">${numsStr}</div></div>`;
            plainText += `[${count}æ¬¡](${nums.length}ä¸ª): ${numsStr}\n`;
        });
        output.innerHTML = html; statsTextForCopy = plainText; btnCopy.style.display = 'flex';
    }

    window.clearStats = function() { if(confirm('ç¡®å®šæ¸…ç©ºï¼Ÿ')) { document.getElementById('historyInput').value = ''; document.getElementById('statsOutput').innerHTML = ''; document.getElementById('btnCopy').style.display = 'none'; statsTextForCopy = ""; } }
    window.copyStats = function() { copyTextToClipboard(statsTextForCopy, 'btnCopy'); }
    window.copyFilterResults = function() {
        const balls = document.querySelectorAll('#numbersGrid .ball:not(.disabled)');
        if(balls.length === 0) { alert("æ— å·ç å¯å¤åˆ¶"); return; }
        let nums = []; balls.forEach(b => nums.push(b.innerText));
        const text = `ã€æ¨èå·ç ã€‘å…±${nums.length}ä¸ª:\n${nums.join(', ')}`;
        copyTextToClipboard(text, 'btnCopyResult');
    }

    function copyTextToClipboard(text, btnId) {
        if (!text) return;
        const btn = document.getElementById(btnId);
        const originalText = btn.innerHTML;
        const doCopy = (txt) => {
            const textArea = document.createElement("textarea"); textArea.value = txt;
            textArea.style.position = "fixed"; textArea.style.left = "-9999px";
            document.body.appendChild(textArea); textArea.focus(); textArea.select();
            try { document.execCommand('copy'); showSuccess(btn, originalText); } catch (err) { alert("å¤åˆ¶å¤±è´¥"); }
            document.body.removeChild(textArea);
        };
        if (navigator.clipboard && window.isSecureContext) { navigator.clipboard.writeText(text).then(() => showSuccess(btn, originalText)).catch(() => doCopy(text)); } else { doCopy(text); }
    }
    function showSuccess(btn, originalText) { btn.innerHTML = 'âœ… å·²å¤åˆ¶'; btn.style.background = '#2ecc71'; btn.style.color = 'white'; setTimeout(() => { btn.innerHTML = originalText; btn.style.background = ''; btn.style.color = ''; }, 2000); }

    window.applyCustomFilter = function() {
        const inputVal = document.getElementById('customFilterInput').value; if (!inputVal.trim()) return;
        const numMatches = inputVal.match(/\b(0?[1-9]|[1-4][0-9])\b/g);
        if (numMatches) { numMatches.forEach(n => { const num = parseInt(n, 10); if (!activeFilters.customNums.includes(num)) activeFilters.customNums.push(num); }); }
        zodiacs.forEach(z => { if (inputVal.includes(z)) { if (!activeFilters.zodiac.includes(z)) { activeFilters.zodiac.push(z); const btns = document.querySelectorAll('#zodiacFilters .filter-btn'); btns.forEach(btn => { if (btn.innerText.includes(z)) btn.classList.add('active'); }); } } });
        renderGrid();
    }
    function initYearSelect() { const select = document.getElementById('yearZodiac'); zodiacs.forEach((z, index) => { const opt = document.createElement('option'); opt.value = index; opt.text = z + "å¹´"; if (z === 'è›‡') opt.selected = true; select.add(opt); }); }
    function initApp() { currentZodiacIndex = parseInt(document.getElementById('yearZodiac').value); const zContainer = document.getElementById('zodiacFilters'); zContainer.innerHTML = ''; zodiacs.forEach(z => { const btn = document.createElement('button'); btn.className = 'filter-btn'; btn.innerText = "æ€" + z; btn.onclick = function() { toggleFilter('zodiac', z, this); }; zContainer.appendChild(btn); }); renderGrid(); }
    function renderGrid() {
        const grid = document.getElementById('numbersGrid'); grid.innerHTML = ''; let validCount = 0;
        for (let i = 1; i <= totalNums; i++) {
            const info = getNumInfo(i); const isExcluded = checkFilter(i, info);
            const div = document.createElement('div'); div.className = `ball ${info.color} ${isExcluded ? 'disabled' : ''}`;
            div.innerText = i < 10 ? '0' + i : i; if (!isExcluded) validCount++; grid.appendChild(div);
        }
        document.getElementById('result-count').innerText = validCount;
    }
    function getNumInfo(num) {
        let color = 'gray'; if (waves.red.includes(num)) color = 'red'; else if (waves.blue.includes(num)) color = 'blue'; else if (waves.green.includes(num)) color = 'green';
        let zIndex = (currentZodiacIndex - (num - 1)) % 12; if (zIndex < 0) zIndex += 12; return { num, color, zodiac: zodiacs[zIndex] };
    }
    function checkFilter(num, info) {
        if (activeFilters.color.includes(info.color)) return true;
        if (activeFilters.parity.includes('odd') && num % 2 !== 0) return true;
        if (activeFilters.parity.includes('even') && num % 2 === 0) return true;
        if (activeFilters.size.includes('small') && num <= 24) return true;
        if (activeFilters.size.includes('big') && num >= 25) return true;
        if (activeFilters.zodiac.includes(info.zodiac)) return true;
        if (activeFilters.tail.includes(num % 10)) return true;
        if (activeFilters.head.includes(Math.floor(num / 10))) return true;
        if (activeFilters.customNums.includes(num)) return true;
        return false;
    }
    window.toggleFilter = function(cat, val, btn) { const idx = activeFilters[cat].indexOf(val); if (idx === -1) { activeFilters[cat].push(val); btn.classList.add('active'); } else { activeFilters[cat].splice(idx, 1); btn.classList.remove('active'); } renderGrid(); }
    window.resetFilters = function() { activeFilters = { color: [], parity: [], size: [], zodiac: [], tail: [], head: [], customNums: [] }; document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active')); document.getElementById('customFilterInput').value = ''; renderGrid(); }
</script>
</body>
</html>